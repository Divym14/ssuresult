<%-include("partials/header")%>
        <div class="chartWrapper" >
        <canvas id="myChart"></canvas>
        </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.8.0/chart.min.js" integrity="sha512-sW/w8s4RWTdFFSduOTGtk4isV1+190E/GghVffMA9XczdJ2MDzSzLEubKAs5h0wzgSJOQTRYyaz73L3d6RtJSg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script>
      var subjectsName = [];
      var subjectsTotal =[];
      var avgData = [];
      var topData = [];

      async function dummyChart(){
        await getDummyData();

        const ctx = document.getElementById("myChart");
        const myChart = new Chart(ctx,{
          type:"line",
          data:{
            labels:subjectsName,
            datasets:[{
              label:"You",
              data:subjectsTotal,
              backgroundColor: "rgba(255, 99, 132, 0.2)",
              borderColor: "rgba(255, 99, 132, 1)",
              borderWidth:5,
              fill:false,
              tension:0.2
            },
            {
              label:"Average",
              data:avgData,
              backgroundColor: "rgba(255, 99, 132, 0.2)",
              borderColor: "rgba(26, 37, 122)",
              borderWidth:5,
              fill:false,
              tension:0.2
            },
            {
              label:"Top",
              data:topData,
              backgroundColor: "rgba(255, 99, 132, 0.2)",
              borderColor: "rgba(66, 245, 126)",
              borderWidth:5,
              fill:false,
              tension:0.2
            }]

          },

          options: {
            animations: {
        radius: {
          duration: 400,
          easing: 'linear',
          loop: (context) => context.active
        }
      },
      hoverRadius: 12,
      hoverBackgroundColor: 'yellow',
      interaction: {
        mode: 'nearest',
        intersect: false,
        axis: 'x'
      },
            scales: {
                y: {
                    beginAtZero: true
                }
            }
        }
      });
      }

    dummyChart();


    async function getDummyData() {
     const apiUrl = "http://localhost:3000/analytics/data"

      const response = await fetch(apiUrl);
      const chartsData = await response.json();
      chartsData[0].forEach(function(chartData,index){
        subjectsName[index] = chartData.opt;
        subjectsTotal[index] = chartData.val;
      });

      avgData = chartsData[1];
      topData = chartsData[2];


    }


    </script>

<%-include("partials/footer")%>
